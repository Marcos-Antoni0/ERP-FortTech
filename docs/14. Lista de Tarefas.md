# Lista de Tarefas - ERP FortTech

## 14. Lista de Tarefas

### Sprint 1: Design System e Refatoração de Configurações (5 dias)

| Tarefa | Subtarefa | Escopo e Implementação | Checklist |
| :--- | :--- | :--- | :--- |
| **T1.0** | **Setup e Padrões** | Configurar ambiente de desenvolvimento e ferramentas de *linting* (ex: *flake8*). | [X] |
| | T1.1 | Aplicar aspas simples e PEP 8 no código base. | [X] |
| **T2.0** | **Design System** | Definir e aplicar classes utilitárias do Tailwind para o Design System. | [X] |
| | T2.1 | Criar classes para a paleta de cores (`#002d6c`, `#007da0`, `#ffffff`). | [X] |
| | T2.2 | Criar componentes base (botões primário/secundário, *inputs*, *forms*) com o novo padrão visual. | [X] |
| | T2.3 | Garantir que o fundo de páginas e modais seja `#ffffff`. | [X] |
| **T3.0** | **Configurações** | Refatorar a aba "Sobre" para "Configurações". | [X] |
| | T3.1 | Renomear a rota `/about/` para `/configuracoes/` em `core/urls.py`. | [X] |
| | T3.2 | Criar a *Class Based View* (CBV) `ConfiguracoesView` em `core/views.py`. | [X] |
| | T3.3 | Criar o *template* `core/configuracoes.html` com arquitetura responsiva. | [X] |
| | T3.4 | Adicionar campo de seleção de impressora padrão no modelo `Company` ou em um novo modelo `ConfiguracaoSistema`. | [X] |
| | T3.5 | Implementar a lógica de salvar a impressora padrão para o *tenant* atual. | [X] |

### Sprint 2: Impressão e Estoque XML (7 dias)

| Tarefa | Subtarefa | Escopo e Implementação | Checklist |
| :--- | :--- | :--- | :--- |
| **T4.0** | **Impressão Automática** | Implementar o *trigger* de impressão após a finalização da venda. | [X] |
| | T4.1 | Corrigir o *trigger* de impressão automática para disparar o `receipt_caixa.html` ao finalizar a venda no PDV. | [X] |
| | T4.2 | Criar a função de impressão que lê a impressora padrão configurada. | [X] |
| | T4.3 | Integrar a função de impressão no fluxo de finalização de venda, comandas e pedidos. | [X] |
| **T4.4** | **Impressão Manual** | Corrigir o layout de impressão manual em todos os recibos (exceto o automático) para evitar corte de informações e unificar o layout com base no `receipt_caixa.html`. | [X] |
| **T4.5** | **Layout XML** | Aumentar o tamanho dos campos de custo e preço no modal de pré-visualização XML para visualização completa dos valores. | [X] |
| **T4.6** | **Lógica XML** | Implementar a lógica de preenchimento automático: custo com valor unitário da nota (XML) e preço com valor de venda do produto. | [X] |
| **T5.0** | **Entrada XML** | Desenvolver a funcionalidade de importação de estoque via XML. | [X] |
| | T5.1 | Criar a *Class Based View* (CBV) `EstoqueXMLUploadView` em `inventory/views.py`. | [X] |
| | T5.2 | Criar o *template* para *upload* de arquivo XML. | [X] |
| | T5.3 | Implementar a lógica de *parsing* do XML para extrair dados de produtos/estoque. | [X] |
| | T5.4 | Criar o *template* de **modal** com interface de planilha (Excel-like) para pré-visualização e edição. | [X] |
| | T5.5 | Implementar a lógica de *backend* para receber os dados editados do modal e atualizar/criar o estoque (modelo `Estoque`). | [X] |
| | T5.6 | Adicionar *signals.py* em `inventory` se necessário para a lógica de estoque. | [X] |

### Sprint 3: Clientes e Débitos (10 dias)

| Tarefa | Subtarefa | Escopo e Implementação | Checklist |
| :--- | :--- | :--- | :--- |
| **T6.0** | **Setup Clientes/Débitos** | Criar as novas *apps* `clients` e `debts` e configurar no `settings.py`. | [X] |
| **T7.0** | **Clientes** | Desenvolvimento da funcionalidade de Clientes. | [X] |
| | T7.1 | Criar o modelo `Client` em `clients/models.py` (com `TenantMixin`). | [X] |
| | T7.2 | Criar a *Class Based View* (CBV) para cadastro e listagem de clientes. | [X] |
| | T7.3 | Implementar a lógica para calcular e exibir o **histórico de consumo** do cliente. | [X] |
| | T7.4 | Implementar a lógica para exibir os **débitos pendentes** do cliente. | [X] |
| **T8.0** | **Débitos** | Desenvolvimento da funcionalidade de Débitos. | [X] |
| | T8.1 | Criar o modelo `Debt` em `debts/models.py` (com `TenantMixin`, FK para `Client`). | [X] |
| | T8.2 | Criar a *Class Based View* (CBV) para registro de novos débitos. | [X] |
| | T8.3 | Criar a *Class Based View* (CBV) para visualização do **histórico completo** de débitos. | [X] |
| | T8.4 | Implementar a lógica de **baixa** (pagamento) de débito, registrando data e forma de pagamento. | [X] |
| **T9.0** | **Integração** | Integrar as novas funcionalidades ao fluxo de vendas. | [X] |
| | T9.1 | Adicionar campo opcional de `client` ao modelo `Sales` ou `Pedido`. | [X] |
| | T9.2 | Ajustar o fluxo de vendas para permitir o registro de débitos (venda a prazo). | [X] |
| | T9.3 | Adicionar links de acesso às novas funcionalidades no Navbar. | [X] |

### Sprint 4: Melhorias e Ajustes Gerais (7 dias)

| Tarefa | Subtarefa | Escopo e Implementação | Checklist |
| :--- | :--- | :--- | :--- |
| **T10.0** | **Delivery** | Adicionar **múltiplas opções de pagamento em delivery** (atualmente tem apenas na Venda e em Mesa). | [X] |
| **T11.0** | **Clientes** | Melhorias na funcionalidade de Clientes. | [X] |
| | T11.1 | Adicionar opção **Excluir cliente** em Clientes (com confirmação). | [X] |
| | T11.2 | Adicionar **Campo de pesquisa cliente pelo nome** na listagem. | [X] |
| **T12.0** | **Débitos** | Melhorias na funcionalidade de Débitos. | [X] |
| | T12.1 | Implementar **Campo de pesquisa por data em débitos**. | [X] |
| | T12.2 | Corrigir *bug* em **Editar débito** (fica sem valor no campo ao clicar em editar). | [X] |
| **T13.0** | **Estoque** | Ajuste na lógica de estoque. | [X] |
| | T13.1 | Permitir realizar **vendas, pedidos ou adicionar em comanda** para venda mesmo com **estoque negativo** (ajuste na validação de estoque). | [X] |
| **T14.0** | **Vendas/Checkout** | Ajustes no fluxo de vendas. | [X] |
| | T14.1 | Ajustar a **Posição do componente seleção de cliente** em *checkout* para melhor usabilidade, pois o componente aparece em outro lugar do modal. | [X] |

### Sprint 5: Reestruturação de Vendas a Prazo e Débitos (8 dias)

| Tarefa | Subtarefa | Escopo e Implementação | Checklist |
| :--- | :--- | :--- | :--- |
| **T18.0** | **Lógica de Vendas a Prazo** | Reestruturar a lógica de vendas a prazo para integração com débitos. | [X] |
| | T18.1 | Modificar a lógica de checkout para permitir finalização de venda mesmo com saldo a receber quando "Registrar pagamento a prazo" estiver ativo. | [X] |
| | T18.2 | Implementar validação no checkout: se "Registrar pagamento a prazo" estiver marcado, criar registro automático em débitos com o valor total ou parcial pendente. | [X] |
| | T18.3 | Adicionar campo `venda_a_prazo` (boolean) no modelo `Sales` para identificar vendas realizadas a prazo. | [X] |
| | T18.4 | Garantir que ao marcar "Registrar pagamento a prazo", o sistema mantenha o valor total da venda e registre o saldo devedor automaticamente. | [X] |
| **T19.0** | **Integração Débitos e Vendas** | Integrar o sistema de débitos com o fluxo de vendas. | [X] |
| | T19.1 | Criar relacionamento entre `Debt` e `Sales` (ForeignKey ou campo de referência) para rastreabilidade. | [X] |
| | T19.2 | Ao finalizar venda a prazo, criar registro automático em `Debt` vinculado ao cliente e à venda. | [X] |
| | T19.3 | Implementar lógica para registrar no débito: valor total/parcial pendente, data da venda, cliente selecionado. | [X] |
| | T19.4 | Adicionar validação para exigir seleção de cliente quando "Registrar pagamento a prazo" estiver ativo. | [X] |
| **T20.0** | **Fechamento de Caixa** | Adicionar informações de vendas a prazo no relatório de fechamento. | [X] |
| | T20.1 | Criar seção "Vendas a Prazo" no relatório de fechamento de caixa. | [X] |
| | T20.2 | Calcular e exibir o total de vendas realizadas a prazo no período do caixa. | [X] |
| | T20.3 | Separar valores: **Total Vendido** (incluindo a prazo), **Total Apurado** (valores recebidos em dinheiro/cartão), **Vendas a Prazo** (valores em débito). | [X] |
| | T20.4 | Adicionar listagem detalhada das vendas a prazo com: cliente, valor, data/hora. | [X] |
| **T21.0** | **Relatórios - Card de Débitos** | Adicionar card de débitos totais na tela de relatórios. | [X] |
| | T21.1 | Criar card "Débitos Totais" na página de relatórios (dashboard). | [X] |
| | T21.2 | Implementar lógica para somar todos os débitos pendentes (não pagos) dos clientes. | [X] |
| | T21.3 | Exibir no card: valor total de débitos pendentes, quantidade de clientes com débitos, link para visualização detalhada. | [X] |
| | T21.4 | Adicionar indicador visual (cor/ícone) para destacar débitos altos ou vencidos. | [X] |
| **T22.0** | **Ajustes de Interface** | Melhorar a interface do checkout para vendas a prazo. | [X] |
| | T22.1 | Reorganizar o modal de checkout para melhor visibilidade da opção "Registrar pagamento a prazo". | [X] |
| | T22.2 | Adicionar tooltip/informação explicativa sobre como funciona o pagamento a prazo. | [X] |
| | T22.3 | Implementar feedback visual quando venda a prazo for registrada com sucesso (mensagem de confirmação). | [X] |
| | T22.4 | Garantir que o campo de seleção de cliente seja obrigatório e destacado quando pagamento a prazo estiver ativo. | [X] |

### Sprint 6: Ajustes Finais e Configurações (5 dias)

| Tarefa | Subtarefa | Escopo e Implementação | Checklist |
| :--- | :--- | :--- | :--- |
| **T15.0** | **Configurações** | Adicionar novas opções de personalização. | [X] |
| | T15.1 | Botar em **Configurações** a opção de **abrir tela de impressão ou não ao registrar uma venda** (toggle). | [X] |
| | T15.2 | Melhorar **layout da aba Configurações** (Adicionar um navbar das opções dentro de configurações e redirecionar para cada tela conforme a opção selecionada). | [X] |
| **T16.0** | **Fechamento de Caixa** | Ajustes finais no relatório de fechamento. | [X] |
| | T16.1 | Validar e testar a exibição correta de **vendas débito** separadas do **total vendido e apurado**. | [X] |
| **T17.0** | **Operador** | Ajuste na exibição de informações. | [X] |
| | T17.1 | Em tela de **operador**, adicionar o **nome** ao invés do usuário (username). | [X] |

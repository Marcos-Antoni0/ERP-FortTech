# Lista de Tarefas - ERP FortTech (ATUALIZADA)

## Sprints Anteriores (Concluídas)

### Sprint 1: Design System e Refatoração de Configurações ✅
### Sprint 2: Impressão e Estoque XML ✅
### Sprint 3: Clientes e Débitos ✅
### Sprint 4: Melhorias e Ajustes Gerais ✅
### Sprint 5: Reestruturação de Vendas a Prazo e Débitos ✅
### Sprint 6: Ajustes Finais e Configurações ✅

---

## Sprint 7: Catálogo Público com Integração WhatsApp (15 dias)

### Fase 1: Infraestrutura e Modelos (Dias 1-3)

| ID | Tarefa | Subtarefa | Escopo e Implementação | Checklist | Prioridade |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **T23.0** | **Setup Inicial** | Configurar nova app e estrutura base | | | **ALTA** |
| | T23.1 | Criar nova app Django `public_catalog` e registrar em `INSTALLED_APPS` | Executar `python manage.py startapp public_catalog` e adicionar em settings.py | [x] | ALTA |
| | T23.2 | Configurar URLs da app com prefixo `/catalogo/` | Criar `public_catalog/urls.py` e incluir em `p_v/urls.py` | [x] | ALTA |
| | T23.3 | Criar estrutura de templates `public_catalog/templates/public_catalog/` | Estrutura de pastas para templates isolados | [x] | MÉDIA |
| **T24.0** | **Modelos de Dados** | Criar modelos para gestão do catálogo público | | | **ALTA** |
| | T24.1 | Criar modelo `CatalogSettings` com configurações por tenant | Campos: `company` (FK), `catalog_enabled` (bool), `whatsapp_number` (str), `custom_message_template` (text), `display_prices` (bool), `catalog_slug` (unique), `primary_color`, `logo` (image) | [x] | ALTA |
| | T24.2 | Criar modelo `CatalogCategory` estendendo Category | Adicionar campos: `display_order` (int), `is_visible_public` (bool), `image` (ImageField), `description_public` (text) | [x] | ALTA |
| | T24.3 | Criar modelo `CatalogProduct` estendendo Products | Adicionar campos: `is_visible_public` (bool), `images` (relação many-to-many com ProductImage), `highlighted` (bool), `display_order` (int), `public_description` (rich text) | [x] | ALTA |
| | T24.4 | Criar modelo `ProductImage` | Campos: `product` (FK), `image` (ImageField), `is_primary` (bool), `display_order` (int), `alt_text` (str) | [x] | MÉDIA |
| | T24.5 | Criar modelo `CatalogOrder` para rastreamento de pedidos | Campos: `company` (FK), `customer_name`, `customer_phone`, `items` (JSON), `total_value`, `status`, `whatsapp_sent_at`, `created_at`, `order_number` (unique), `customer_notes` | [x] | MÉDIA |
| | T24.6 | Criar migrações e aplicar ao banco de dados | `python manage.py makemigrations && python manage.py migrate` | [x] | ALTA |

### Fase 2: Área Administrativa (Dias 4-6)

| ID | Tarefa | Subtarefa | Escopo e Implementação | Checklist | Prioridade |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **T25.0** | **Configurações do Catálogo** | Desenvolver interface de configuração | | | **ALTA** |
| | T25.1 | Criar CBV `CatalogSettingsView` com formulário de configuração | View para GET (carregar) e POST (salvar) configurações do catálogo | [x] | ALTA |
| | T25.2 | Criar form `CatalogSettingsForm` com validações | Validar formato do número WhatsApp, slug único, etc. | [x] | ALTA |
| | T25.3 | Criar template `catalog_settings.html` com design responsivo | Incluir upload de logo, configuração de cores, toggle de exibição de preços | [x] | ALTA |
| | T25.4 | Implementar preview em tempo real das configurações | JavaScript para mostrar preview das cores e mensagem | [x] | MÉDIA |
| | T25.5 | Adicionar validação de número WhatsApp (formato internacional) | Regex para validar formato: +55 (85) 98888-8888 | [x] | MÉDIA |
| **T26.0** | **Gestão de Produtos no Catálogo** | Interface para gerenciar visibilidade de produtos | | | **ALTA** |
| | T26.1 | Criar CBV `CatalogProductListView` com listagem de produtos | Exibir todos os produtos com toggle de visibilidade | [x] | ALTA |
| | T26.2 | Criar CBV `CatalogProductUpdateView` para editar produto | Permitir upload de múltiplas imagens, definir produto em destaque, ordem de exibição | [x] | ALTA |
| | T26.3 | Criar form `CatalogProductForm` com campos específicos | Campos: imagens, descrição pública, visibilidade, ordem | [x] | ALTA |
| | T26.4 | Criar template `catalog_product_list.html` com filtros | Filtrar por categoria, status de visibilidade, produtos em destaque | [x] | MÉDIA |
| | T26.5 | Criar template `catalog_product_edit.html` | Interface drag-and-drop para upload e reordenação de imagens | [x] | MÉDIA |
| | T26.6 | Implementar ação em massa "Tornar visível/invisível" | Checkbox para seleção múltipla de produtos | [x] | BAIXA |
| **T27.0** | **Gestão de Categorias** | Interface para gerenciar categorias públicas | | | **MÉDIA** |
| | T27.1 | Criar CBV `CatalogCategoryListView` | Listar categorias com opção de tornar visível/invisível | [x] | MÉDIA |
| | T27.2 | Criar CBV `CatalogCategoryUpdateView` | Editar ordem de exibição, imagem da categoria, descrição pública | [x] | MÉDIA |
| | T27.3 | Criar form `CatalogCategoryForm` | Campos: imagem, descrição pública, ordem, visibilidade | [x] | MÉDIA |
| | T27.4 | Criar templates de listagem e edição de categorias | Interface similar à de produtos | [x] | MÉDIA |
| | T27.5 | Implementar reordenação drag-and-drop de categorias | JavaScript para reordenar visualmente e salvar ordem | [x] | BAIXA |

### Fase 3: Interface Pública do Catálogo (Dias 7-10)

| ID | Tarefa | Subtarefa | Escopo e Implementação | Checklist | Prioridade |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **T28.0** | **Views Públicas** | Criar views sem autenticação para o catálogo | | | **CRÍTICA** |
| | T28.1 | Criar view `PublicCatalogHomeView` (página inicial do catálogo) | Usar slug da empresa na URL: `/catalogo/<slug>/` | [x] | CRÍTICA |
| | T28.2 | Criar view `PublicCatalogCategoryView` (produtos por categoria) | URL: `/catalogo/<slug>/categoria/<category_id>/` | [x] | ALTA |
| | T28.3 | Criar view `PublicCatalogProductDetailView` (detalhes do produto) | URL: `/catalogo/<slug>/produto/<product_id>/` | [x] | ALTA |
| | T28.4 | Implementar sistema de carrinho em session | Usar Django sessions para armazenar itens selecionados | [x] | CRÍTICA |
| | T28.5 | Criar view `PublicCatalogCartView` (visualização do carrinho) | URL: `/catalogo/<slug>/carrinho/` | [x] | ALTA |
| **T29.0** | **Templates Frontend Público** | Desenvolver interface responsiva para clientes | | | **CRÍTICA** |
| | T29.1 | Criar `base_public.html` com design limpo e responsivo | Base template sem navbar administrativa, footer com info da empresa | [x] | CRÍTICA |
| | T29.2 | Criar `public_catalog_home.html` | Grid de categorias, produtos em destaque, barra de busca | [x] | CRÍTICA |
| | T29.3 | Criar `public_catalog_category.html` | Grid de produtos da categoria com imagens, preços, botão "Adicionar" | [x] | ALTA |
| | T29.4 | Criar `public_catalog_product_detail.html` | Galeria de imagens, descrição completa, quantidade, botão adicionar ao carrinho | [x] | ALTA |
| | T29.5 | Criar `public_catalog_cart.html` | Lista de itens, quantidades editáveis, total, botão finalizar pedido | [x] | CRÍTICA |
| | T29.6 | Implementar modal de confirmação de item adicionado | Feedback visual com opção "Continuar comprando" ou "Ver carrinho" | [x] | MÉDIA |
| **T30.0** | **Funcionalidades do Carrinho** | Implementar lógica de carrinho de compras | | | **CRÍTICA** |
| | T30.1 | Criar função `add_to_cart(request, product_id, quantity)` | Adicionar produto à sessão com validações | [x] | CRÍTICA |
| | T30.2 | Criar função `update_cart_item(request, product_id, quantity)` | Atualizar quantidade de item no carrinho | [x] | ALTA |
| | T30.3 | Criar função `remove_from_cart(request, product_id)` | Remover item do carrinho | [x] | ALTA |
| | T30.4 | Criar função `get_cart_items(request)` e `get_cart_total(request)` | Helpers para recuperar informações do carrinho | [x] | ALTA |
| | T30.5 | Implementar AJAX para adicionar/remover sem reload de página | Endpoints JSON para operações do carrinho | [x] | MÉDIA |
| **T31.0** | **Design e Estilização** | Criar identidade visual do catálogo público | | | **ALTA** |
| | T31.1 | Criar CSS customizado com variáveis de tema | Aplicar cores configuradas pelo usuário (primary_color) | [x] | ALTA |
| | T31.2 | Implementar design responsivo mobile-first | Garantir excelente experiência em smartphones | [x] | CRÍTICA |
| | T31.3 | Criar animações e transições suaves | Hover effects, transições de modais, scroll suave | [x] | MÉDIA |
| | T31.4 | Otimizar imagens com lazy loading | Usar `loading="lazy"` e srcset para responsividade | [x] | MÉDIA |
| | T31.5 | Implementar skeleton loaders para melhor UX | Indicadores de carregamento enquanto busca produtos | [x] | BAIXA |

### Fase 4: Integração WhatsApp (Dias 11-12)

| ID | Tarefa | Subtarefa | Escopo e Implementação | Checklist | Prioridade |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **T32.0** | **Finalização de Pedido** | Implementar fluxo de checkout | | | **CRÍTICA** |
| | T32.1 | Criar view `CatalogCheckoutView` para formulário de dados do cliente | Campos: nome, telefone, observações | [x] | CRÍTICA |
| | T32.2 | Criar form `CheckoutForm` com validações | Validar telefone, nome obrigatório | [x] | ALTA |
| | T32.3 | Criar template `public_catalog_checkout.html` | Resumo do pedido + formulário de dados | [x] | ALTA |
| | T32.4 | Implementar salvamento do pedido em `CatalogOrder` | Salvar JSON com itens, totais, dados do cliente | [x] | CRÍTICA |
| | T32.5 | Gerar número único de pedido (formato: YYYYMMDD-XXXX) | Usar timezone e contador incremental | [x] | MÉDIA |
| **T33.0** | **Geração de Mensagem WhatsApp** | Formatar mensagem estruturada para WhatsApp | | | **CRÍTICA** |
| | T33.1 | Criar função `generate_whatsapp_message(order)` | Montar mensagem com template configurável | [x] | CRÍTICA |
| | T33.2 | Implementar template de mensagem com variáveis | Suportar: {customer_name}, {order_number}, {items}, {total}, {notes} | [x] | ALTA |
| | T33.3 | Formatar lista de itens de forma legível | Exemplo: "• 2x Pizza Margherita - R$ 40,00" | [x] | ALTA |
| | T33.4 | Criar função `format_whatsapp_number(number)` | Remover formatação e adicionar prefixo internacional | [x] | MÉDIA |
| **T34.0** | **Redirecionamento WhatsApp** | Implementar envio automático para WhatsApp | | | **CRÍTICA** |
| | T34.1 | Criar view `SendToWhatsAppView` | Receber order_id, gerar mensagem, redirecionar | [x] | CRÍTICA |
| | T34.2 | Construir URL do WhatsApp com mensagem encoded | Formato: `https://wa.me/5585988888888?text=<mensagem_encoded>` | [x] | CRÍTICA |
| | T34.3 | Implementar tracking de clique no botão WhatsApp | Atualizar `whatsapp_sent_at` em `CatalogOrder` | [x] | MÉDIA |
| | T34.4 | Criar página de confirmação pós-envio | Informar que pedido foi enviado e fornecer número do pedido | [x] | ALTA |
| | T34.5 | Implementar fallback se número WhatsApp não estiver configurado | Exibir mensagem de erro amigável e opções alternativas | [x] | MÉDIA |

### Fase 5: Gestão de Pedidos (Dias 13-14)

| ID | Tarefa | Subtarefa | Escopo e Implementação | Checklist | Prioridade |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **T35.0** | **Painel de Pedidos** | Criar interface administrativa para pedidos recebidos | | | **ALTA** |
| | T35.1 | Criar CBV `CatalogOrderListView` com filtros | Filtrar por data, status, cliente | [x] | ALTA |
| | T35.2 | Criar CBV `CatalogOrderDetailView` | Visualizar detalhes completos do pedido | [x] | ALTA |
| | T35.3 | Criar template `catalog_order_list.html` | Tabela responsiva com paginação | [x] | ALTA |
| | T35.4 | Criar template `catalog_order_detail.html` | Exibir itens, valores, dados do cliente, histórico | [x] | MÉDIA |
| | T35.5 | Implementar mudança de status do pedido | Estados: novo, em_preparo, enviado, entregue, cancelado | [x] | ALTA |
| | T35.6 | Adicionar botão de ação rápida "Enviar para Sistema de Pedidos" | Converter pedido do catálogo em pedido interno (orders app) | [x] | MÉDIA |
| **T36.0** | **Relatórios e Analytics** | Criar visualizações de performance do catálogo | | | **MÉDIA** |
| | T36.1 | Criar dashboard com estatísticas de pedidos | Métricas: total de pedidos, valor médio, produtos mais vendidos | [x] | MÉDIA |
| | T36.2 | Implementar gráfico de pedidos por período | Usar Chart.js ou biblioteca similar | [x] | BAIXA |
| | T36.3 | Criar relatório de produtos mais visualizados | Implementar tracking de visualizações de produtos | [x] | BAIXA |
| | T36.4 | Exportar pedidos para CSV/Excel | Facilitar análise externa de dados | [x] | BAIXA |

### Fase 6: Segurança e Otimização (Dia 15)

| ID | Tarefa | Subtarefa | Escopo e Implementação | Checklist | Prioridade |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **T37.0** | **Segurança** | Implementar proteções e validações | | | **CRÍTICA** |
| | T37.1 | Implementar rate limiting em views públicas | Prevenir abuso (máx 100 req/hora por IP) | [x] | CRÍTICA |
| | T37.2 | Adicionar CSRF tokens em todos os formulários | Proteção contra CSRF attacks | [x] | CRÍTICA |
| | T37.3 | Implementar validação de origem das requisições | Verificar referrer para operações críticas | [x] | ALTA |
| | T37.4 | Sanitizar inputs do usuário (XSS protection) | Usar Django's escape e bleach library | [x] | CRÍTICA |
| | T37.5 | Implementar CAPTCHA em formulário de checkout | Prevenir bots (Google reCAPTCHA) | [ ] | ALTA |
| | T37.6 | Adicionar logs de auditoria para ações administrativas | Registrar quem alterou configurações do catálogo | [x] | MÉDIA |
| **T38.0** | **Performance** | Otimizar carregamento e performance | | | **ALTA** |
| | T38.1 | Implementar cache de queries frequentes | Cachear lista de produtos/categorias por 15 min | [x] | ALTA |
| | T38.2 | Otimizar queries com select_related e prefetch_related | Reduzir N+1 queries | [x] | ALTA |
| | T38.3 | Implementar compressão de imagens no upload | Usar Pillow para redimensionar e comprimir | [x] | ALTA |
| | T38.4 | Adicionar CDN para servir imagens estáticas | Configurar whitenoise ou CloudFlare | [x] | MÉDIA |
| | T38.5 | Implementar paginação infinita na listagem de produtos | Scroll infinito ao invés de paginação tradicional | [x] | BAIXA |
| **T39.0** | **SEO e Compartilhamento** | Otimizar para buscadores e redes sociais | | | **MÉDIA** |
| | T39.1 | Adicionar meta tags Open Graph em todas as páginas | Melhorar preview ao compartilhar links | [ ] | MÉDIA |
| | T39.2 | Implementar schema.org markup para produtos | Structured data para Google Shopping | [ ] | MÉDIA |
| | T39.3 | Criar sitemap.xml dinâmico do catálogo | Facilitar indexação pelos buscadores | [ ] | BAIXA |
| | T39.4 | Implementar canonical URLs | Evitar conteúdo duplicado | [ ] | BAIXA |
| | T39.5 | Adicionar botões de compartilhamento social | WhatsApp, Facebook, copiar link | [ ] | BAIXA |
| **T40.0** | **Testes e QA** | Garantir qualidade e funcionamento correto | | | **CRÍTICA** |
| | T40.1 | Criar testes unitários para models e forms | Cobertura mínima de 70% | [ ] | ALTA |
| | T40.2 | Criar testes de integração para fluxo completo | Testar desde visualização até envio WhatsApp | [ ] | ALTA |
| | T40.3 | Realizar testes de responsividade em múltiplos dispositivos | iPhone, Android, tablets, desktop | [ ] | ALTA |
| | T40.4 | Testar performance com banco de dados populado | Simular 500+ produtos e 1000+ pedidos | [ ] | MÉDIA |
| | T40.5 | Executar testes de segurança (penetration testing básico) | Verificar vulnerabilidades comuns (OWASP Top 10) | [ ] | ALTA |
| | T40.6 | Realizar teste de usabilidade com usuários reais | Coletar feedback de 3-5 usuários | [ ] | MÉDIA |

---

## Tarefas Complementares (Pós-Sprint 7)

### Melhorias Futuras

| ID | Tarefa | Descrição | Prioridade |
| :--- | :--- | :--- | :--- |
| **T41** | **Notificações Push** | Implementar notificações para novos pedidos via Telegram/Discord | BAIXA |
| **T42** | **Multi-idioma** | Adicionar suporte a português e inglês | BAIXA |
| **T43** | **Programa de Fidelidade** | Integrar sistema de pontos para clientes recorrentes | BAIXA |
| **T44** | **Cupons de Desconto** | Sistema de cupons aplicáveis no checkout | MÉDIA |
| **T45** | **Agendamento de Pedidos** | Permitir cliente agendar pedido para data/hora específica | MÉDIA |
| **T46** | **Avaliações de Produtos** | Sistema de review e rating de produtos | BAIXA |
| **T47** | **Integração Delivery** | Integrar com iFood, Rappi, etc. | MÉDIA |
| **T48** | **App Mobile** | Desenvolver aplicativo nativo (React Native ou Flutter) | BAIXA |

---

## Dependências Técnicas

### Pacotes Python Necessários
```txt
# Adicionais para Sprint 7
Pillow>=10.0.0  # Processamento de imagens
django-ckeditor>=6.7.0  # Editor rich text
django-ratelimit>=4.1.0  # Rate limiting
bleach>=6.1.0  # Sanitização de HTML
```

### Configurações de Mídia
```python
# settings.py
MEDIA_URL = '/media/'
MEDIA_ROOT = BASE_DIR / 'media'

# Adicionar em INSTALLED_APPS
'public_catalog',
'ckeditor',
'ckeditor_uploader',
```

---

## Estimativas de Tempo

| Fase | Duração Estimada | Complexidade |
| :--- | :--- | :--- |
| Fase 1: Infraestrutura e Modelos | 3 dias | Média |
| Fase 2: Área Administrativa | 3 dias | Média-Alta |
| Fase 3: Interface Pública | 4 dias | Alta |
| Fase 4: Integração WhatsApp | 2 dias | Média |
| Fase 5: Gestão de Pedidos | 2 dias | Média |
| Fase 6: Segurança e Otimização | 1 dia | Alta |
| **TOTAL** | **15 dias** | |

---

## Critérios de Sucesso

- [ ] Catálogo público acessível via URL personalizada
- [ ] Produtos com múltiplas imagens carregando corretamente
- [ ] Carrinho de compras funcionando com sessões
- [ ] Pedidos sendo enviados para WhatsApp com mensagem formatada
- [ ] Painel administrativo completo para gestão
- [ ] Sistema responsivo em mobile (smartphones)
- [ ] Testes de segurança aprovados
- [ ] Performance: carregamento < 3s em 4G
- [ ] Taxa de conversão visitante → pedido > 5%
- [ ] Zero erros críticos em produção após 1 semana

---

## Notas de Implementação

### Arquitetura de Segurança
- **Acesso Público**: Views do catálogo NÃO requerem autenticação
- **Isolamento de Dados**: Filtragem por `company` baseada no slug da URL
- **Validações**: Rate limiting + CAPTCHA + sanitização de inputs
- **Auditoria**: Logs de todas as ações administrativas

### Fluxo do Pedido
1. Cliente navega pelo catálogo público
2. Adiciona produtos ao carrinho (session-based)
3. Preenche dados no checkout
4. Sistema gera número único de pedido
5. Monta mensagem WhatsApp formatada
6. Redireciona para WhatsApp Web/App
7. Registro do pedido salvo no sistema
8. Empresa visualiza pedido no painel administrativo
9. Empresa pode converter pedido em venda no sistema interno

### Personalização
- Cada empresa tem seu próprio catálogo via slug único
- Cores, logo e mensagens personalizáveis
- Opção de exibir ou ocultar preços
- Template de mensagem WhatsApp customizável

---

**Versão:** 2.0  
**Data:** 08/02/2026  
**Autor:** Equipe de Desenvolvimento  
**Status:** Em Planejamento
